if(is.na(digitos)){
base
} else if(digitos==1){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo)&is.na(base$division),] %>% select(seccion,glosa)
} else if(digitos==2){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),] %>% filter(!is.na(division)) %>% select(seccion,division,glosa)
} else if(digitos==3){
base[is.na(base$subclase)&is.na(base$clase),] %>% filter(!is.na(grupo)) %>% select(seccion,grupo,glosa)
} else if(digitos==4){
base[is.na(base$clase),] %>% filter(!is.na(clase)) %>% select(seccion,clase,glosa)
} else if(digitos==5){
base[!is.na(base$subclase),] %>% select(seccion,subclase,glosa)
} else{
print("Incorrecto número de digitos. Coloque 1, 2, 3, 4 o 5")
}
}
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
ciiu_digitos(3)
ciiu_digitos(4)
ciiu_digitos(4)
ciiu_digitos(3)
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),] %>% filter(!is.na(division))
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base[is.na(base$subclase)&is.na(base$clase),] %>% filter(!is.na(grupo))
base[is.na(base$clase),] %>% filter(!is.na(clase))
base[is.na(base$clase),]
base[!is.na(base$clase),]
base[!is.na(base$clase)&is.na(base$subclase),]
base[!is.na(base$subclase),]
ciiu_digitos <- function(digitos=NA_real_){
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(is.na(digitos)){
base
} else if(digitos==1){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo)&is.na(base$division),] %>% select(seccion,glosa)
} else if(digitos==2){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),] %>% filter(!is.na(division)) %>% select(seccion,division,glosa)
} else if(digitos==3){
base[is.na(base$subclase)&is.na(base$clase),] %>% filter(!is.na(grupo)) %>% select(seccion,grupo,glosa)
} else if(digitos==4){
base[!is.na(base$clase)&is.na(base$subclase),]  %>% select(seccion,clase,glosa)
} else if(digitos==5){
base[!is.na(base$subclase),] %>% select(seccion,subclase,glosa)
} else{
print("Incorrecto número de digitos. Coloque 1, 2, 3, 4 o 5")
}
}
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
ciiu_digitos(3)
ciiu_digitos(4)
ciiu_digitos(5)
ciiu_digitos(6)
library(tidyverse)
ciiu <- function(let=NA_character_,div=NA_character_,gru=NA_character_,
cla=NA_character_,sub=NA_character_){
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
base %>% filter(seccion==let)
} else if(!is.na(div)){
base %>% filter(division==div)
} else if(!is.na(sub)){
base %>% filter(subclase==sub)
} else{
base
}
}
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(sub="01220")
ciiu <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_){
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
base %>% filter(seccion==let)
} else if(!is.na(div)){
base %>% filter(division==div)
} else if(!is.na(gru)){
base %>% filter(grupo==gru)
} else if(!is.na(cla)){
base %>% filter(clase==clase)
} else if(!is.na(sub)){
base %>% filter(subclase==sub)
} else{
base
}
}
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(div="472")
ciiu(div="4719")
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(gru="472")
ciiu(cla="4719")
ciiu(cla="4719")
ciiu(gru="472")
ciiu <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_){
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
base %>% filter(seccion==let)
} else if(!is.na(div)){
base %>% filter(division==div)
} else if(!is.na(gru)){
base %>% filter(grupo==gru)
} else if(!is.na(cla)){
base %>% filter(clase==cla)
} else if(!is.na(sub)){
base %>% filter(subclase==sub)
} else{
base
}
}
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(gru="472")
ciiu(cla="4719")
ciiu(sub="01220")
ciiu(cla="4719")
ciiu(cla="4719")
ciiu(sub="47199")
ciiu <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_){
base <- readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1)  %>% janitor::clean_names()
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
dplyr::filter(base,seccion==let)
} else if(!is.na(div)){
dplyr::filter(base,division==div)
} else if(!is.na(gru)){
dplyr::filter(base,grupo==gru)
} else if(!is.na(cla)){
dplyr::filter(base,clase==cla)
} else if(!is.na(sub)){
dplyr::filter(base,subclase==sub)
} else{
base
}
}
ciiu()
ciiu <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_){
base <- janitor::clean_names(readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1))
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
dplyr::filter(base,seccion==let)
} else if(!is.na(div)){
dplyr::filter(base,division==div)
} else if(!is.na(gru)){
dplyr::filter(base,grupo==gru)
} else if(!is.na(cla)){
dplyr::filter(base,clase==cla)
} else if(!is.na(sub)){
dplyr::filter(base,subclase==sub)
} else{
base
}
}
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(gru="472")
ciiu(cla="4719")
ciiu(sub="47199")
devtools::document()
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(gru="472")
ciiu(cla="4719")
ciiu(sub="47199")
ciiu_digitos <- function(digitos=NA_real_){
base <- janitor::clean_names(readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1))
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(is.na(digitos)){
base
} else if(digitos==1){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo)&is.na(base$division),c("seccion","glosa")]
} else if(digitos==2){
aux <- base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),c("seccion","division","glosa")]
dplyr::filter(aux, !is.na(division))
} else if(digitos==3){
aux <- base[is.na(base$subclase)&is.na(base$clase),c("seccion","grupo","glosa")]
dplyr::filter(aux, !is.na(grupo))
} else if(digitos==4){
base[!is.na(base$clase)&is.na(base$subclase),c("seccion","clase","glosa")]
} else if(digitos==5){
base[!is.na(base$subclase),c("seccion","subclase","glosa")]
} else{
print("Incorrecto número de digitos. Coloque 1, 2, 3, 4 o 5")
}
}
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
ciiu_digitos(3)
ciiu_digitos(4)
ciiu_digitos(5)
ciiu_digitos(6)
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
ciiu_digitos(3)
ciiu_digitos(4)
ciiu_digitos(5)
ciiu_digitos(6)
devtools::document()
usethat::use_vignette("introduction")
install.packages("usethat")
usethat::use_vignette("introduction")
devtools::use_vignette("introduction")
usethat::use_vignette("introduction")
library(ciiu2012cl)
base <- janitor::clean_names(readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1))
devtools::use_data(base)
system.file("extdata", "model-coef.tsv", package = "myfirstpackage")
system.file("extdata", "CIIU4.CL 2012.xlsx", package = "myfirstpackage")
save(base, file="data/ciiu.RData")
x <- (function(...)get(data(...,envir = new.env())))("faithful")
View(x)
x <- (function(...)get(data(...,envir = new.env())))("ciiu")
data(ciiu)
ciiu <- reaxl::read_excel("data-raw/CIIU4.CL 2012.xlsx")
ciiu <- readxl::read_excel("data-raw/CIIU4.CL 2012.xlsx")
usethis::use_data(ciiu, internal = TRUE, overwrite = TRUE)
ciiu <- janitor::clean_names(readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1))
usethis::use_data(ciiu, internal = TRUE, overwrite = TRUE)
ciiu
ciiu
"ciiu"
base <- readRDS("R/sysdata.rda")
base <- get0("sysdata.rds", envir = asNamespace("ciiu2012cl"))
base <- get0("R/sysdata.rds", envir = asNamespace("ciiu2012cl"))
base <- get0("R/sysdata.rda", envir = asNamespace("ciiu2012cl"))
get0("R/sysdata.rda", envir = asNamespace("ciiu2012cl"))
devtools::use_data(sysdata.rda, internal = TRUE)
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- janitor::clean_names(readxl::read_excel("CIIU4.CL 2012.xlsx",skip = 1))
usethis::use_data(base, internal = TRUE, overwrite = TRUE)
load("~/Github/ciiu2012cl/R/sysdata.rda")
load("~/Github/ciiu2012cl/R/sysdata.rda")
ciiu <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(!is.na(let)){
dplyr::filter(base,seccion==let)
} else if(!is.na(div)){
dplyr::filter(base,division==div)
} else if(!is.na(gru)){
dplyr::filter(base,grupo==gru)
} else if(!is.na(cla)){
dplyr::filter(base,clase==cla)
} else if(!is.na(sub)){
dplyr::filter(base,subclase==sub)
} else{
base
}
}
ciiu()
ciiu("G")
ciiu(div="47")
ciiu(gru="472")
ciiu(cla="4719")
ciiu(sub="47199")
#'
#' La función retorna todos los elementos contenidos en la desagregación
#' consultada.
#'
#'
#'
#' @param digitos Indicar el número de desglose de CIIU 2012
#' @return Una tibble con las glosas según desglose solicitado
#' @export
#'
ciiu_digitos <- function(digitos=NA_real_){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(is.na(digitos)){
base
} else if(digitos==1){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo)&is.na(base$division),c("seccion","glosa")]
} else if(digitos==2){
aux <- base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),c("seccion","division","glosa")]
dplyr::filter(aux, !is.na(division))
} else if(digitos==3){
aux <- base[is.na(base$subclase)&is.na(base$clase),c("seccion","grupo","glosa")]
dplyr::filter(aux, !is.na(grupo))
} else if(digitos==4){
base[!is.na(base$clase)&is.na(base$subclase),c("seccion","clase","glosa")]
} else if(digitos==5){
base[!is.na(base$subclase),c("seccion","subclase","glosa")]
} else{
print("Incorrecto número de digitos. Coloque 1, 2, 3, 4 o 5")
}
}
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
#'
#' La función retorna todos los elementos contenidos en la desagregación
#' consultada.
#'
#'
#'
#' @param digitos Indicar el número de desglose de CIIU 2012
#' @return Una tibble con las glosas según desglose solicitado
#' @export
#'
ciiu_digitos <- function(digitos=NA_real_){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
if(is.na(digitos)){
base
} else if(digitos==1){
base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo)&is.na(base$division),c("seccion","glosa")]
} else if(digitos==2){
aux <- base[is.na(base$subclase)&is.na(base$clase)&
is.na(base$grupo),c("seccion","division","glosa")]
dplyr::filter(aux, !is.na(division))
} else if(digitos==3){
aux <- base[is.na(base$subclase)&is.na(base$clase),c("seccion","grupo","glosa")]
dplyr::filter(aux, !is.na(grupo))
} else if(digitos==4){
base[!is.na(base$clase)&is.na(base$subclase),c("seccion","clase","glosa")]
} else if(digitos==5){
base[!is.na(base$subclase),c("seccion","subclase","glosa")]
} else{
print("Incorrecto número de digitos. Coloque 1, 2, 3, 4 o 5")
}
}
ciiu_digitos()
ciiu_digitos(1)
ciiu_digitos(2)
ciiu_digitos(3)
devtools::document()
devtools::document()
devtools::document()
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base
buscar <- "Alcohol"
tolower(buscar)
base$glosa <- tolower(base$glosa)
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base$glosa_low <- tolower(base$glosa)
buscar <- "Alcohol"
base$glosa_low
buscar <- "Alcohol"
filter(base,stringr::str_detect(glosa_low,tolower(buscar)))
base
100000/5000
547*5000
dplyr::filter(base,stringr::str_detect(glosa_low,"agricultura"))
tolower(buscar)
dplyr::filter(base,stringr::str_detect(glosa_low,tolower(buscar)))
buscar <- "Agro"
dplyr::filter(base,stringr::str_detect(glosa_low,tolower(buscar)))
dplyr::select(dplyr::filter(base,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
dplyr::select(dplyr::filter(base,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
ciiu_glosa <- function(palabras=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_,
buscar=""){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base$glosa_low <- tolower(base$glosa)
if(!is.na(let)){
aux <- dplyr::filter(base,seccion==let)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(div)){
aux <- dplyr::filter(base,division==div)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(gru)){
aux <- dplyr::filter(base,grupo==gru)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(cla)){
aux <- dplyr::filter(base,clase==cla)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(sub)){
aux <- dplyr::filter(base,subclase==sub)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else{
aux <- base
}
}
ciiu_consulta()
ciiu_glosa()
ciiu_glosa()
ciiu_glosa("G")
ciiu_glosa(div="47")
ciiu_glosa(gru="472")
ciiu_glosa(cla="4719")
ciiu_glosa(sub="47199")
ciiu_glosa(buscar="Agro")
ciiu_glosa <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_,
buscar=""){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base$glosa_low <- tolower(base$glosa)
if(!is.na(let)){
aux <- dplyr::filter(base,seccion==let)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(div)){
aux <- dplyr::filter(base,division==div)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(gru)){
aux <- dplyr::filter(base,grupo==gru)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(cla)){
aux <- dplyr::filter(base,clase==cla)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(sub)){
aux <- dplyr::filter(base,subclase==sub)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else{
aux <- base
}
}
ciiu_glosa()
ciiu_glosa("G")
ciiu_glosa(div="47")
ciiu_glosa(gru="472")
ciiu_glosa(cla="4719")
ciiu_glosa(sub="47199")
ciiu_glosa(buscar="Agro")
ciiu_glosa <- function(let=NA_character_,
div=NA_character_,
gru=NA_character_,
cla=NA_character_,
sub=NA_character_,
buscar=""){
load("~/Github/ciiu2012cl/R/sysdata.rda")
base <- base[,c("seccion","division","grupo","clase","subclase","glosa")]
base$glosa_low <- tolower(base$glosa)
if(!is.na(let)){
aux <- dplyr::filter(base,seccion==let)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(div)){
aux <- dplyr::filter(base,division==div)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(gru)){
aux <- dplyr::filter(base,grupo==gru)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(cla)){
aux <- dplyr::filter(base,clase==cla)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else if(!is.na(sub)){
aux <- dplyr::filter(base,subclase==sub)
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
} else{
aux <- base
dplyr::select(dplyr::filter(aux,stringr::str_detect(glosa_low,tolower(buscar))),-"glosa_low")
}
}
ciiu_glosa()
ciiu_glosa("G")
ciiu_glosa(div="47")
ciiu_glosa(gru="472")
ciiu_glosa(cla="4719")
ciiu_glosa(sub="47199")
ciiu_glosa(buscar="Agro")
ciiu_glosa(let="G",buscar="Agro")
devtools::document()
